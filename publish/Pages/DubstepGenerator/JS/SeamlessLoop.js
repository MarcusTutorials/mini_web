function SeamlessLoop(){this.is={ff:Boolean(!(null==window.mozInnerScreenX)&&/firefox/.test(navigator.userAgent.toLowerCase())),ie:Boolean(document.all&&!window.opera),opera:Boolean(window.opera),chrome:Boolean(window.chrome),safari:Boolean(!window.chrome&&/safari/.test(navigator.userAgent.toLowerCase())&&window.getComputedStyle&&!window.globalStorage&&!window.opera)},console.debug("ff: "+this.is.ff),console.debug("ie: "+this.is.ie),console.debug("opera: "+this.is.opera),console.debug("chrome: "+this.is.chrome),console.debug("safari: "+this.is.safari),this._total=0,this._load=0,this.cb_loaded,this.cb_loaded_flag=new Boolean,this.timeout,this.playDelay=-30,this.stopDelay=30,this.is.chrome&&(this.playDelay=-25),this.is.chrome&&(this.stopDelay=25),this.is.ff&&(this.playDelay=-25),this.is.ff&&(this.stopDelay=85),this.is.opera&&(this.playDelay=5),this.is.opera&&(this.stopDelay=0),console.debug(this.playDelay+", "+this.stopDelay),this.next=1,this.audios=new Array,this.actual=new Array,this.dropOld=new Boolean,this.old,this._volume=1;var t=this;this._eventCanplaythrough=function(o){0==o&&(o=!0,t._load++,t._load==t._total&&(t.loaded=!0,1==t.cb_loaded_flag&&(t.cb_loaded(),t.cb_loaded_flag=!1)))},this._eventPlaying=function(o){setTimeout((function(){o.pause();try{o.currentTime=0}catch(t){console.debug(t.message)}}),t.stopDelay),1==t.dropOld&&(setTimeout((function(){if(0==t.old.paused){t.old.pause();try{t.old.currentTime=0}catch(t){console.debug(t.message)}}}),t.stopDelay),t.dropOld=!1)},this._eventEnded=function(t){t.volume=this._volume},this.doLoop=function(){var t=1==this.next?"_1":"_2",o=1==this.next?"_2":"_1",e=this;this.timeout=setTimeout((function(){e.doLoop()}),this.actual._length+this.playDelay),this.is.opera&&this.actual[o].pause(),this.actual[t].play(),this.next*=-1},this.isLoaded=function(){return Boolean(this._load==this._total)}}SeamlessLoop.prototype.start=function(t){""!=t&&(this.actual=this.audios[t]),this.doLoop()},SeamlessLoop.prototype.volume=function(t){return void 0!==t&&(this.actual._1.volume=t,this.actual._2.volume=t,this._volume=t),t},SeamlessLoop.prototype.stop=function(){clearTimeout(this.timeout),this.actual._1.currentTime=0,this.actual._1.pause(),this.actual._2.currentTime=0,this.actual._2.pause()},SeamlessLoop.prototype.callback=function(t){this.cb_loaded=t,1==this.isLoaded()?t():this.cb_loaded_flag=!0},SeamlessLoop.prototype.update=function(t,o){var e=1==this.next?"_2":"_1";this.old=this.actual[e],this.actual=this.audios[t],0==o&&(0==this.old.paused&&(this.dropOld=!0,this.is.opera&&this.old.pause()),clearTimeout(this.timeout),this.doLoop())},SeamlessLoop.prototype.addUri=function(t,o,e){this.audios[e]=new Array,this.audios[e]._length=o;var i=this;this.audios[e]._1_isLoaded=new Boolean,this.audios[e]._2_isLoaded=new Boolean,this.audios[e]._1=new Audio(t),this.audios[e]._2=new Audio(t),this._total++,this.audios[e]._1.addEventListener("canplaythrough",(function(){i._eventCanplaythrough(i.audios[e]._1_isLoaded)})),this.audios[e]._2.addEventListener("canplaythrough",(function(){i._eventCanplaythrough(i.audios[e]._2_isLoaded)})),this.audios[e]._1.addEventListener("playing",(function(){i._eventPlaying(i.audios[e]._2)})),this.audios[e]._2.addEventListener("playing",(function(){i._eventPlaying(i.audios[e]._1)})),this.audios[e]._1.addEventListener("ended",(function(){i._eventEnded(i.audios[e]._1)})),this.audios[e]._2.addEventListener("ended",(function(){i._eventEnded(i.audios[e]._2)})),this.audios[e]._1.load(),this.audios[e]._2.load(),this.audios[e]._1.volume=this._volume,this.audios[e]._2.volume=this._volume};
//# sourceMappingURL=SeamlessLoop.js.map
